# ãƒ—ãƒªã‚»ãƒƒãƒˆã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«UIè¨­è¨ˆæ›¸

## Issue: #107 ãƒ—ãƒªã‚»ãƒƒãƒˆã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«UIãƒ»éŽå‰°æ¤œå‡ºåˆ¤å®šãƒ»ã‚¿ã‚°å‚¾å‘åˆ†æž

## å¤§åŽŸå‰‡ã®å®£è¨€

æœ¬è¨­è¨ˆã¯ä»¥ä¸‹ã®å¤§åŽŸå‰‡ã‚’éµå®ˆã—ã¾ã™ï¼š
1. **SSoT**: ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾©ã¯PresetLoaderå˜ä¸€ã‚½ãƒ¼ã‚¹ã¨ã™ã‚‹
2. **SOLID**: å˜ä¸€è²¬ä»»ï¼ˆçµ±è¨ˆåˆ†æžã€éŽå‰°æ¤œå‡ºåˆ¤å®šã€UIã¯åˆ†é›¢ï¼‰
3. **MECE**: æ¤œå‡ºå‚¾å‘ã®ã‚«ãƒ†ã‚´ãƒªã¯ç›¸äº’æŽ’ä»–ãƒ»ç¶²ç¾…çš„ã«å®šç¾©
4. **è»Šè¼ªã®å†ç™ºæ˜Žç¦æ­¢**: æ—¢å­˜ã®InferenceStatsService, AutoAttunementServiceã‚’æ´»ç”¨

---

## 1. æ¦‚è¦

### 1.1 èƒŒæ™¯ãƒ»èª²é¡Œ

ç¾çŠ¶ã®å•é¡Œç‚¹ï¼š
- **ã‚¿ã‚°å›ºå®šåŒ–å•é¡Œ**: PAR100Kãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ãƒã‚¤ã‚¢ã‚¹ã«ã‚ˆã‚Šã€15ç¨®é¡žã®ã‚¿ã‚°ï¼ˆcarry.bag, outfit.pantsç­‰ï¼‰ãŒã»ã¼å…¨æ¤œå‡ºã§å‡ºç¾
- **éŽå‰°æ¤œå‡º**: åŒä¸€ã‚«ãƒ¡ãƒ©ã§é¡žä¼¼ã‚¤ãƒ™ãƒ³ãƒˆãŒç¹°ã‚Šè¿”ã—æ¤œå‡ºã•ã‚Œã‚‹ãŒã€å¯è¦–åŒ–ã•ã‚Œã¦ã„ãªã„
- **ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžã®å›°é›£ã•**: ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰æ›´ã®å½±éŸ¿ãŒäº‹å‰ã«ã‚ã‹ã‚‰ãªã„
- **ã‚«ã‚¹ã‚¿ãƒ èª¿æ•´ã®å°Žç·šä¸è¶³**: ç‰¹å®šã‚¿ã‚°ã®éŽå‰°æ¤œå‡ºã«å¯¾ã™ã‚‹èª¿æ•´æ–¹æ³•ãŒä¸æ˜Žç¢º

### 1.2 è¦ä»¶ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åŽŸæ–‡ï¼‰

> ã€Œçµ±è¨ˆãƒ­ã‚°ã‚’è¦‹ã¦æ˜Žã‚‰ã‹ã«éŽå‰°æ¤œå‡ºã—ã¦ã„ã‚‹ã€‚â†’ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰ãˆã‚‹ã‹æ¤œå‡ºãƒ¬ãƒ™ãƒ«ä¸‹ã’ã‚‹ã€
> ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžæ™‚ã¯ã©ã‚“ãªãƒãƒ©ãƒ³ã‚¹ã‹ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ã«ã‚ã‹ã‚‹(ã‚¹ãƒšã‚¯ãƒˆãƒ©ãƒ ã ã¨ã‚ã‹ã‚Šã¥ã‚‰ã„ã‹ã‚‰æ£’ã‚°ãƒ©ãƒ•ï¼Ÿ
> é¸æŠžã—ãŸãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰ãˆã‚‹ã¨æ¤œå‡ºå‚¾å‘ãŒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§ã‚°ãƒ©ãƒ•ãŒå‹•ã)
> æ˜Žã‚‰ã‹ã«ç‰¹å®šã®å›ºå®šç‰©ã«åå¿œã—ã¦ã„ã‚‹ã€ç‰¹å®šã®ã‚¿ã‚°ã°ã‹ã‚Šã¤ãã‚ˆã†ãªã‚‰ãã“ã®éƒ¨åˆ†ã‚’ã„ã˜ã‚‹â†’ã‚«ã‚¹ã‚¿ãƒ ã€
> å‚¾å‘ã ã‘ãªã®ã§çµ±è¨ˆãŒå‡ºã‚‹ãªã‚‰LLMã§ãªãã¦ã‚‚ã‚ã‚‹ç¨‹åº¦éŽå‰°æ¤œå‡ºã®åˆ¤å®šã¯ãƒ­ã‚¸ãƒƒã‚¯ã§å¯èƒ½ã€

### 1.3 ã‚¹ã‚³ãƒ¼ãƒ—

**å¯¾è±¡**:
- ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžUIï¼ˆã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«æ£’ã‚°ãƒ©ãƒ•è¡¨ç¤ºï¼‰
- éŽå‰°æ¤œå‡ºåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆLLMä¸è¦ï¼‰
- ã‚¿ã‚°å‚¾å‘åˆ†æžãƒ»è¡¨ç¤º
- ã‚«ã‚¹ã‚¿ãƒ èª¿æ•´å°Žç·š

**å¯¾è±¡å¤–**:
- IS21å´ã®PAR100Kãƒ¢ãƒ‡ãƒ«æ”¹ä¿®ï¼ˆåˆ¥Issueï¼‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¡¨ç¤º

---

## 2. æ©Ÿèƒ½è¨­è¨ˆ

### 2.1 ãƒ—ãƒªã‚»ãƒƒãƒˆãƒãƒ©ãƒ³ã‚¹å¯è¦–åŒ–

#### 2.1.1 æ£’ã‚°ãƒ©ãƒ•è¡¨ç¤º

```typescript
interface PresetBalance {
  preset_id: string;
  detection_sensitivity: number;  // 0-100 (conf_overrideåŸºæº–)
  person_detail: number;          // 0-100 (par_thresholdåŸºæº–)
  object_variety: number;         // 0-100 (excluded_objectsæ•°åŸºæº–)
  motion_sensitivity: number;     // 0-100 (enable_frame_diffåŸºæº–)
}
```

**è¨ˆç®—å¼**:
- `detection_sensitivity = (1 - conf_override) * 100`ï¼ˆä½Žé–¾å€¤ = é«˜æ„Ÿåº¦ï¼‰
- `person_detail = (1 - par_threshold) * 100`ï¼ˆä½Žé–¾å€¤ = è©³ç´°å¤šï¼‰
- `object_variety = 100 - (excluded_objects.length / 20 * 100)`
- `motion_sensitivity = enable_frame_diff ? 80 : 20`

#### 2.1.2 ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãåˆ‡ã‚Šæ›¿ãˆ

ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžå¤‰æ›´æ™‚ã€ç¾åœ¨å€¤â†’æ–°ãƒ—ãƒªã‚»ãƒƒãƒˆå€¤ã¸ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é·ç§»ï¼š
- Duration: 500ms
- Easing: ease-out
- å„æ£’ã‚°ãƒ©ãƒ•ãŒå€‹åˆ¥ã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

### 2.2 éŽå‰°æ¤œå‡ºåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯

#### 2.2.1 åˆ¤å®šã‚«ãƒ†ã‚´ãƒªï¼ˆMECEï¼‰

| ã‚«ãƒ†ã‚´ãƒª | å®šç¾© | é–¾å€¤ |
|---------|------|------|
| **å›ºå®šç‰©åå¿œ** | åŒä¸€åº§æ¨™(Â±5%)ã§åŒä¸€ãƒ©ãƒ™ãƒ«æ¤œå‡ºãŒç¹°ã‚Šè¿”ã•ã‚Œã‚‹ | 10ä»¶/æ™‚é–“ä»¥ä¸Š |
| **ã‚¿ã‚°å›ºå®šåŒ–** | ç‰¹å®šã‚¿ã‚°ãŒå…¨æ¤œå‡ºã®80%ä»¥ä¸Šã§å‡ºç¾ | 24æ™‚é–“ã§80%ä»¥ä¸Š |
| **é«˜é »åº¦æ¤œå‡º** | æ¤œå‡ºæ•°ãŒZ-score > 2.0 | çµ±è¨ˆçš„å¤–ã‚Œå€¤ |
| **Unknownä¹±ç™º** | unknownçŽ‡ãŒ30%è¶…éŽ | 30%ä»¥ä¸Š |

#### 2.2.2 åˆ¤å®šSQL

```sql
-- å›ºå®šç‰©åå¿œãƒã‚§ãƒƒã‚¯
SELECT
  camera_id,
  ROUND(bbox_x / image_width * 20) as x_zone,
  ROUND(bbox_y / image_height * 20) as y_zone,
  primary_label,
  COUNT(*) as repeat_count
FROM detection_logs
WHERE created_at >= DATE_SUB(NOW(), INTERVAL 1 HOUR)
GROUP BY camera_id, x_zone, y_zone, primary_label
HAVING repeat_count >= 10;

-- ã‚¿ã‚°å›ºå®šåŒ–ãƒã‚§ãƒƒã‚¯
SELECT
  camera_id,
  JSON_UNQUOTE(JSON_EXTRACT(tags, '$[0]')) as tag,
  COUNT(*) as tag_count,
  (SELECT COUNT(*) FROM detection_logs dl2
   WHERE dl2.camera_id = dl.camera_id
   AND dl2.created_at >= DATE_SUB(NOW(), INTERVAL 24 HOUR)) as total_count,
  COUNT(*) * 100 / (SELECT COUNT(*) FROM detection_logs dl2
   WHERE dl2.camera_id = dl.camera_id
   AND dl2.created_at >= DATE_SUB(NOW(), INTERVAL 24 HOUR)) as tag_rate
FROM detection_logs dl
WHERE created_at >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
  AND tags IS NOT NULL AND tags != '[]'
GROUP BY camera_id, tag
HAVING tag_rate >= 80;
```

### 2.3 ã‚¿ã‚°å‚¾å‘åˆ†æž

#### 2.3.1 ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```rust
#[derive(Debug, Clone, Serialize)]
pub struct TagTrend {
    pub tag: String,
    pub count: i64,
    pub percentage: f64,
    pub is_over_detected: bool,  // 80%ä»¥ä¸Šã§ true
    pub trend: TrendDirection,   // å¢—åŠ /æ¸›å°‘/å®‰å®š
}

#[derive(Debug, Clone, Serialize)]
pub enum TrendDirection {
    Increasing,  // å‰æ—¥æ¯” +10%ä»¥ä¸Š
    Decreasing,  // å‰æ—¥æ¯” -10%ä»¥ä¸Š
    Stable,      // å¤‰å‹• Â±10%ä»¥å†…
}
```

#### 2.3.2 UIè¡¨ç¤º

- æ£’ã‚°ãƒ©ãƒ•ï¼šã‚¿ã‚°åˆ¥æ¤œå‡ºæ•°ï¼ˆä¸Šä½10ä»¶ï¼‰
- è‰²åˆ†ã‘ï¼šéŽå‰°æ¤œå‡ºã‚¿ã‚°ã¯èµ¤ã€æ­£å¸¸ã¯é’
- ãƒ›ãƒãƒ¼ï¼šè©³ç´°ï¼ˆæ¤œå‡ºæ•°ã€å‰²åˆã€å‚¾å‘ï¼‰

### 2.4 ã‚«ã‚¹ã‚¿ãƒ èª¿æ•´å°Žç·š

#### 2.4.1 éŽå‰°æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆã‹ã‚‰ã®å°Žç·š

```
[éŽå‰°æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆ: carry.bag ãŒ85%ã§å‡ºç¾]
  â†“
[èª¿æ•´ã‚ªãƒ—ã‚·ãƒ§ãƒ³]
  â”œâ”€ [ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰æ›´] â†’ ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžUIã¸
  â”œâ”€ [é–¾å€¤èª¿æ•´] â†’ PARé–¾å€¤ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã¸
  â””â”€ [ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼] â†’ ã‚¿ã‚°é™¤å¤–è¨­å®šã¸
```

#### 2.4.2 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®š

```typescript
interface CustomTagFilter {
  camera_id: string;
  excluded_tags: string[];  // é™¤å¤–ã™ã‚‹ã‚¿ã‚°
  tag_thresholds: {         // ã‚¿ã‚°åˆ¥é–¾å€¤
    [tag: string]: number;  // 0.0-1.0
  };
}
```

---

## 3. APIè¨­è¨ˆ

### 3.1 æ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜Ž |
|----------|------|------|
| GET | `/api/presets/balance` | å…¨ãƒ—ãƒªã‚»ãƒƒãƒˆã®ãƒãƒ©ãƒ³ã‚¹å€¤å–å¾— |
| GET | `/api/stats/overdetection` | éŽå‰°æ¤œå‡ºåˆ¤å®šçµæžœå–å¾— |
| GET | `/api/stats/tags/:camera_id` | ã‚«ãƒ¡ãƒ©åˆ¥ã‚¿ã‚°å‚¾å‘å–å¾— |
| GET | `/api/stats/tags/summary` | å…¨ä½“ã‚¿ã‚°ã‚µãƒžãƒªãƒ¼å–å¾— |
| PUT | `/api/cameras/:id/tag-filter` | ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®š |

### 3.2 ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼

#### GET /api/presets/balance

```json
{
  "presets": [
    {
      "preset_id": "balanced",
      "name": "ãƒãƒ©ãƒ³ã‚¹",
      "balance": {
        "detection_sensitivity": 50,
        "person_detail": 50,
        "object_variety": 30,
        "motion_sensitivity": 80
      }
    },
    {
      "preset_id": "person_priority",
      "name": "äººç‰©å„ªå…ˆ",
      "balance": {
        "detection_sensitivity": 70,
        "person_detail": 60,
        "object_variety": 40,
        "motion_sensitivity": 80
      }
    }
  ]
}
```

#### GET /api/stats/overdetection

```json
{
  "period": "24h",
  "cameras": [
    {
      "camera_id": "cam-001",
      "camera_name": "Tam StorageArea",
      "issues": [
        {
          "type": "tag_fixation",
          "tag": "carry.bag",
          "rate": 85.2,
          "count": 1234,
          "severity": "warning",
          "suggestion": "PARé–¾å€¤ã‚’0.6ä»¥ä¸Šã«ä¸Šã’ã‚‹ã‹ã€ã‚¿ã‚°ã‚’é™¤å¤–ãƒªã‚¹ãƒˆã«è¿½åŠ "
        },
        {
          "type": "static_object",
          "label": "person",
          "zone": "x:12,y:8",
          "repeat_count": 45,
          "severity": "critical",
          "suggestion": "å›ºå®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å¯èƒ½æ€§ã€‚excluded_objectsã«è¿½åŠ æ¤œè¨Ž"
        }
      ]
    }
  ]
}
```

#### GET /api/stats/tags/:camera_id

```json
{
  "camera_id": "cam-001",
  "period": "24h",
  "total_detections": 1500,
  "tags": [
    {
      "tag": "carry.bag",
      "count": 1280,
      "percentage": 85.3,
      "is_over_detected": true,
      "trend": "stable"
    },
    {
      "tag": "outfit.pants",
      "count": 1200,
      "percentage": 80.0,
      "is_over_detected": true,
      "trend": "increasing"
    }
  ]
}
```

---

## 4. UIè¨­è¨ˆ

### 4.1 ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžç”»é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠž                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ ç¾åœ¨ã®ãƒ—ãƒªã‚»ãƒƒãƒˆ: [ãƒãƒ©ãƒ³ã‚¹ â–¼]                               â”‚
â”‚                                                              â”‚
â”‚ â”Œâ”€ æ¤œå‡ºãƒãƒ©ãƒ³ã‚¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                                          â”‚  â”‚
â”‚ â”‚ æ¤œå‡ºæ„Ÿåº¦      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%                  â”‚  â”‚
â”‚ â”‚ äººç‰©è©³ç´°      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%                  â”‚  â”‚
â”‚ â”‚ å¯¾è±¡å¤šæ§˜æ€§    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  30%                  â”‚  â”‚
â”‚ â”‚ å‹•ä½“æ¤œçŸ¥      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80%                  â”‚  â”‚
â”‚ â”‚                                                          â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚ âš ï¸ éŽå‰°æ¤œå‡ºã®è­¦å‘Š                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ”´ carry.bag: 85%ã®æ¤œå‡ºã§å‡ºç¾ï¼ˆå›ºå®šåŒ–ã®ç–‘ã„ï¼‰            â”‚ â”‚
â”‚ â”‚    [é–¾å€¤èª¿æ•´] [ã‚¿ã‚°é™¤å¤–] [ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰æ›´]                â”‚ â”‚
â”‚ â”‚                                                          â”‚ â”‚
â”‚ â”‚ ðŸŸ¡ outfit.pants: 80%ã®æ¤œå‡ºã§å‡ºç¾                         â”‚ â”‚
â”‚ â”‚    [é–¾å€¤èª¿æ•´] [ã‚¿ã‚°é™¤å¤–]                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚ ã‚¿ã‚°åˆ†å¸ƒï¼ˆä¸Šä½10ä»¶ï¼‰                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ carry.bag      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  1280    â”‚ â”‚
â”‚ â”‚ outfit.pants   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    1200    â”‚ â”‚
â”‚ â”‚ gender.male    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              800     â”‚ â”‚
â”‚ â”‚ age.adult      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                720     â”‚ â”‚
â”‚ â”‚ outfit.shorts  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                          320     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ãƒ—ãƒªã‚»ãƒƒãƒˆåˆ‡ã‚Šæ›¿ãˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
// ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰æ›´æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
const animatePresetChange = (
  from: PresetBalance,
  to: PresetBalance,
  duration: number = 500
) => {
  const startTime = performance.now();

  const animate = (currentTime: number) => {
    const elapsed = currentTime - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const eased = 1 - Math.pow(1 - progress, 3); // ease-out

    setCurrentBalance({
      detection_sensitivity: lerp(from.detection_sensitivity, to.detection_sensitivity, eased),
      person_detail: lerp(from.person_detail, to.person_detail, eased),
      object_variety: lerp(from.object_variety, to.object_variety, eased),
      motion_sensitivity: lerp(from.motion_sensitivity, to.motion_sensitivity, eased),
    });

    if (progress < 1) {
      requestAnimationFrame(animate);
    }
  };

  requestAnimationFrame(animate);
};
```

### 4.3 ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ 

| çŠ¶æ…‹ | è‰² | ç”¨é€” |
|------|-----|------|
| æ­£å¸¸ | `#3B82F6` (blue-500) | æ­£å¸¸ç¯„å›²ã®ãƒãƒ¼ |
| è­¦å‘Š | `#F59E0B` (amber-500) | 70-80%ã®éŽå‰°æ¤œå‡º |
| å±é™º | `#EF4444` (red-500) | 80%ä»¥ä¸Šã®éŽå‰°æ¤œå‡º |
| éžæ´»æ€§ | `#9CA3AF` (gray-400) | ç„¡åŠ¹ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ |

---

## 5. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 5.1 Backendï¼ˆRustï¼‰

```
src/
â”œâ”€â”€ overdetection_analyzer/
â”‚   â”œâ”€â”€ mod.rs              # OverdetectionAnalyzer service
â”‚   â”œâ”€â”€ tag_analyzer.rs     # ã‚¿ã‚°å‚¾å‘åˆ†æž
â”‚   â””â”€â”€ static_detector.rs  # å›ºå®šç‰©æ¤œå‡º
â””â”€â”€ web_api/
    â””â”€â”€ routes.rs           # æ–°è¦APIè¿½åŠ 
```

### 5.2 Frontendï¼ˆReactï¼‰

```
frontend/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PresetSelector/
â”‚   â”‚   â”œâ”€â”€ index.tsx           # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ BalanceChart.tsx    # æ£’ã‚°ãƒ©ãƒ•
â”‚   â”‚   â”œâ”€â”€ OverdetectionAlert.tsx  # è­¦å‘Šè¡¨ç¤º
â”‚   â”‚   â””â”€â”€ TagDistribution.tsx # ã‚¿ã‚°åˆ†å¸ƒ
â”‚   â””â”€â”€ SettingsModal.tsx       # çµ±åˆ
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ usePresetAnimation.ts   # ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒƒã‚¯
â””â”€â”€ types/
    â””â”€â”€ preset.ts               # åž‹å®šç¾©
```

---

## 6. MECEãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### 6.1 æ©Ÿèƒ½ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆMECEï¼‰

| ã‚«ãƒ†ã‚´ãƒª | æ©Ÿèƒ½ | å¯¾å¿œ |
|---------|------|------|
| **å¯è¦–åŒ–** | ãƒ—ãƒªã‚»ãƒƒãƒˆãƒãƒ©ãƒ³ã‚¹è¡¨ç¤º | âœ“ æ£’ã‚°ãƒ©ãƒ• |
| | ã‚¿ã‚°åˆ†å¸ƒè¡¨ç¤º | âœ“ æ¨ªæ£’ã‚°ãƒ©ãƒ• |
| | éŽå‰°æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆ | âœ“ è‰²åˆ†ã‘è¡¨ç¤º |
| **åˆ†æž** | ã‚¿ã‚°å›ºå®šåŒ–æ¤œå‡º | âœ“ 80%é–¾å€¤ |
| | å›ºå®šç‰©åå¿œæ¤œå‡º | âœ“ åº§æ¨™ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚° |
| | é«˜é »åº¦æ¤œå‡º | âœ“ Z-score |
| | Unknownä¹±ç™º | âœ“ 30%é–¾å€¤ |
| **æ“ä½œ** | ãƒ—ãƒªã‚»ãƒƒãƒˆå¤‰æ›´ | âœ“ ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ |
| | é–¾å€¤èª¿æ•´ | âœ“ ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆæ—¢å­˜ï¼‰ |
| | ã‚¿ã‚°é™¤å¤–è¨­å®š | âœ“ æ–°è¦è¿½åŠ  |

### 6.2 ã‚¢ãƒ³ã‚¢ãƒ³ãƒ“ã‚®ãƒ¥ã‚¢ã‚¹ç¢ºèª

- å…¨é–¾å€¤ã¯æ˜Žç¢ºã«æ•°å€¤å®šç¾©æ¸ˆã¿
- UIæ“ä½œãƒ•ãƒ­ãƒ¼ã¯å›³ç¤ºæ¸ˆã¿
- APIãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã¯JSONä¾‹ç¤ºæ¸ˆã¿
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»•æ§˜ã¯æ•°å€¤ã§å®šç¾©æ¸ˆã¿

---

## 7. ä¾å­˜é–¢ä¿‚

### 7.1 æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾å­˜

- `InferenceStatsService` - çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—
- `AutoAttunementService` - é–¾å€¤è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
- `PresetLoader` - ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾©
- `DetectionLogService` - æ¤œå‡ºãƒ­ã‚°ã‚¢ã‚¯ã‚»ã‚¹

### 7.2 æ–°è¦è¿½åŠ 

- `OverdetectionAnalyzer` - éŽå‰°æ¤œå‡ºåˆ¤å®šï¼ˆæ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
- `PresetSelector` - ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠžUIï¼ˆæ–°è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰

---

## 8. å®Ÿè£…å„ªå…ˆé †ä½

1. **Phase 1**: Backend APIï¼ˆéŽå‰°æ¤œå‡ºåˆ†æžï¼‰
2. **Phase 2**: Frontend UIï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆãƒãƒ©ãƒ³ã‚¹è¡¨ç¤ºï¼‰
3. **Phase 3**: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
4. **Phase 4**: ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

---

## 9. å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|----------|
| 2026-01-08 | 1.0.0 | åˆç‰ˆä½œæˆ |

---

ä½œæˆè€…: Claude Code
æœ€çµ‚æ›´æ–°: 2026-01-08

# TP-link VIGI ストレステスト報告書

## テスト実施日
2026-01-17

## テスト環境

| 項目 | 値 |
|------|-----|
| カメラ | TP-link VIGI (推定) |
| カメラIP | 192.168.126.124 |
| テストサーバー | IS22 (192.168.125.246) |
| ONVIFポート | 2020 |
| RTSPポート | 554 |
| 認証情報 | admin:mijeos |
| 解像度(Main) | 2304x1296 |
| 解像度(Sub) | 704x576 |
| RTSPパス | /stream1, /stream2 |

---

## 1. テスト結果サマリー

| テスト項目 | 結果 | 評価 |
|-----------|------|------|
| RTSP順次接続 | 5/5成功（100%） | ✅ 優秀 |
| RTSP急速再接続（インターバルなし） | 20/20成功（100%） | ✅ 優秀 |
| RTSP再接続（0.5秒間隔） | 10/10成功（100%） | ✅ 優秀 |
| RTSP再接続（1秒間隔） | 10/10成功（100%） | ✅ 優秀 |
| RTSP再接続（2秒間隔） | 10/10成功（100%） | ✅ 優秀 |
| RTSP長時間ストリーム（30秒） | 成功 | ✅ 優秀 |
| RTSP 2並列接続 | 6/6成功（100%） | ✅ 優秀 |
| RTSP 3並列接続 | 9/9成功（100%） | ✅ 優秀 |
| RTSP 5並列接続 | 6/10成功（60%） | ⚠️ 注意 |
| Main + Sub同時 | 3/3成功（100%） | ✅ 優秀 |
| HTTP急速リクエスト | 20/20成功（100%） | ✅ 優秀 |
| ONVIF（認証なし） | 0/20成功 | ⚠️ 要認証 |

---

## 2. 詳細テスト結果

### 2.1 RTSP順次接続テスト

| 接続 | 結果 | 応答時間 | 解像度 |
|------|------|---------|--------|
| 1 | ✅ SUCCESS | 2275ms | 2304x1296 |
| 2 | ✅ SUCCESS | 2279ms | 2304x1296 |
| 3 | ✅ SUCCESS | 2195ms | 2304x1296 |
| 4 | ✅ SUCCESS | 2202ms | 2304x1296 |
| 5 | ✅ SUCCESS | 2242ms | 2304x1296 |

**平均応答時間**: 約2.2秒

---

### 2.2 RTSP再接続テスト

| インターバル | 成功率 | 詳細 |
|-------------|--------|------|
| 0秒（急速） | **100%** (20/20) | ✅ 完全成功 |
| 0.5秒 | **100%** (10/10) | ✅ 完全成功 |
| 1秒 | **100%** (10/10) | ✅ 完全成功 |
| 2秒 | **100%** (10/10) | ✅ 完全成功 |

**所見**: VIGIは急速な再接続にも完全対応。インターバル不要。

---

### 2.3 長時間ストリームテスト

```
結果: SUCCESS
フレーム数: 601フレーム
平均FPS: 約20fps
ストリーム安定性: 非常に良好
実行時間: 32秒
```

---

### 2.4 RTSP並列接続テスト

| 並列数 | 試行回数 | 成功率 | 詳細 |
|--------|---------|--------|------|
| 2 | 3回 | **100%** (6/6) | ✅ 完全安定 |
| 3 | 3回 | **100%** (9/9) | ✅ 完全安定 |
| 5 | 2回 | **60%** (6/10) | ⚠️ 一部失敗 |

**所見**:
- 3並列までは完全に安定
- 5並列では約40%が失敗
- 推奨最大並列数: **3〜4**

---

### 2.5 Main + Sub 同時接続テスト

| 試行 | Main結果 | Sub結果 | 評価 |
|------|---------|--------|------|
| 1 | 2304x1296 ✅ | 704x576 ✅ | 成功 |
| 2 | 2304x1296 ✅ | 704x576 ✅ | 成功 |
| 3 | 2304x1296 ✅ | 704x576 ✅ | 成功 |

**所見**: Main/Sub同時取得は完全対応。スナップショット取得に最適。

---

### 2.6 HTTPエンドポイントテスト

| テスト | 結果 |
|-------|------|
| 急速リクエスト（20回） | 20/20成功 ✅ |

---

### 2.7 ONVIFテスト

| テスト | 結果 | 備考 |
|-------|------|------|
| 認証なしリクエスト | 0/20 | Digest認証が必要 |

**所見**: ONVIF認証が必要。実運用では認証ヘッダーを設定すること。

---

## 3. 性能特性

### 強み ✅
- **急速再接続に完全対応**（インターバル不要）
- **3並列接続まで安定**
- **Main/Sub同時取得が可能**
- **長時間ストリーミング安定**
- **HTTP応答も安定**

### 弱み ⚠️
- 5並列以上で不安定
- ONVIF認証が必要
- 接続確立に約2.2秒かかる

---

## 4. IS22運用への推奨事項

### 4.1 アクセスガード設定

```
推奨設定:
- 最小再接続間隔: 0秒（制限不要）
- 最大並列接続数: 3
- 接続タイムアウト: 5秒
```

### 4.2 スナップショット取得

```
推奨設定:
- Main/Sub同時取得: 可能
- スナップショット間隔: 制限なし
- リトライ回数: 2回
```

### 4.3 ポーリングスケジュール

```
推奨設定:
- ヘルスチェック間隔: 制限なし
- RTSPプローブ: 制限なし
- 並列プローブ: 3台まで同時OK
```

---

## 5. 結論

**TP-link VIGIは非常に安定したカメラ**であり、IS22での運用に最適。

### 評価
| 項目 | スコア |
|------|--------|
| 再接続安定性 | ★★★★★ (5/5) |
| 並列接続 | ★★★★☆ (4/5) |
| 長時間安定性 | ★★★★★ (5/5) |
| Main/Sub同時 | ★★★★★ (5/5) |
| **総合評価** | **★★★★★ (4.75/5)** |

**特記事項**: アクセスインターバルガードは**不要**。並列接続は3以下に制限することを推奨。

---

## 付録: テストコマンド

### RTSP接続テスト
```bash
ffprobe -rtsp_transport tcp -v error -show_entries stream=width,height -of csv=p=0 \
    "rtsp://admin:mijeos@192.168.126.124:554/stream1"
```

### 長時間ストリームテスト
```bash
timeout 35 ffmpeg -rtsp_transport tcp -i "rtsp://admin:mijeos@192.168.126.124:554/stream1" \
    -t 30 -f null -
```

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aranea.sdk/schemas/types/ISMS_ar-is20s.json",
  "title": "ISMS_ar-is20s Network Monitor",
  "description": "ネットワーク監視デバイス (Orange Pi Zero3)",
  "type": "object",

  "metadata": {
    "productType": "020",
    "productCodes": ["0001", "0096"],
    "displayName": "Network Monitor",
    "capabilities": ["network", "discovery", "monitor", "sync"],
    "semanticTags": ["ネットワーク", "監視", "ARP", "スキャン"],
    "features": [
      "ARPスキャン",
      "サービス検出",
      "ネットワーク監視",
      "クラウド同期",
      "Web UI"
    ]
  },

  "stateSchema": {
    "type": "object",
    "required": ["network"],
    "properties": {
      "network": {
        "type": "object",
        "properties": {
          "deviceCount": {
            "type": "integer",
            "description": "検出デバイス数"
          },
          "localDevices": {
            "type": "integer",
            "description": "ローカル除外済み数"
          },
          "ptrDevices": {
            "type": "integer",
            "description": "PTR除外済み数"
          },
          "lastScan": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "system": {
        "type": "object",
        "properties": {
          "uptime": {
            "type": "integer",
            "description": "稼働時間 (秒)"
          },
          "cpuUsage": {
            "type": "number",
            "description": "CPU使用率 (%)"
          },
          "memoryUsage": {
            "type": "number",
            "description": "メモリ使用率 (%)"
          },
          "diskUsage": {
            "type": "number",
            "description": "ディスク使用率 (%)"
          }
        }
      },
      "sync": {
        "type": "object",
        "properties": {
          "lastSync": {
            "type": "string",
            "format": "date-time"
          },
          "syncStatus": {
            "type": "string",
            "enum": ["idle", "syncing", "success", "error"]
          },
          "pendingCount": {
            "type": "integer",
            "description": "同期待ちイベント数"
          }
        }
      }
    }
  },

  "configSchema": {
    "type": "object",
    "properties": {
      "scan": {
        "type": "object",
        "properties": {
          "interval": {
            "type": "integer",
            "minimum": 60000,
            "maximum": 3600000,
            "default": 300000,
            "description": "スキャン間隔 (ms)"
          },
          "subnet": {
            "type": "string",
            "description": "スキャン対象サブネット"
          },
          "excludeIps": {
            "type": "array",
            "items": { "type": "string" },
            "description": "除外IPリスト"
          }
        }
      },
      "sync": {
        "type": "object",
        "properties": {
          "enabled": {
            "type": "boolean",
            "default": false
          },
          "endpoint": {
            "type": "string",
            "format": "uri"
          },
          "interval": {
            "type": "integer",
            "minimum": 60000,
            "default": 300000
          }
        }
      },
      "tenant": {
        "type": "object",
        "properties": {
          "tid": { "type": "string" },
          "lacisId": { "type": "string" },
          "cic": { "type": "string" }
        }
      }
    }
  },

  "commandSchema": {
    "type": "object",
    "properties": {
      "scan": {
        "type": "object",
        "properties": {},
        "description": "即時スキャン実行"
      },
      "sync": {
        "type": "object",
        "properties": {},
        "description": "即時同期実行"
      },
      "clearCache": {
        "type": "object",
        "properties": {},
        "description": "キャッシュクリア"
      }
    }
  }
}
